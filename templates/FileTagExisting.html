$def with (tvars)
$ title = tvars.get('title')
$ apptarget = tvars.get('apptarget')
$ tagspace = tvars.get('tagspace')
$ data_id = tvars.get('data_id')
$ taginfo = tvars.get('taginfo')
$ urlquote = tvars.get('urlquote')
$if title != '':
	<h2>${title}</h2>
$ excludes, tagdefs, tagdefsdict, tags, filetagvals, length = taginfo
$ excludes = [ x for x in excludes ]
$ excludes.append('owner')
$if title == 'System' and data_id:
	<a href="${apptarget + '/file/' + urlquote(data_id)}">Link to ${data_id}</a>
$if len(filetagvals) > 0:
	$for data_id, tag, vals in filetagvals:
		$ tagname, typestr, writeok = tagdefsdict[tag]
		<fieldset>
		   <legend>${tag}</legend>
			$if typestr:
				$for val in vals:
					<form enctype="application/x-www-form-urlencoded" action="${apptarget + '/' + tagspace + '/' + urlquote(data_id)}" method="post">
					<input type="hidden" name="tag" value="${tag}" />
					<input type="text" name="value" value="${val}" size="${length}" readonly />
					<input type="hidden" name="action" value="delete" />
					$if tag not in excludes and writeok:
						<input type="submit" value="Delete" />
					</form>
			$else:
				<form enctype="application/x-www-form-urlencoded" action="${apptarget + '/' + tagspace + '/' + urlquote(data_id)}" method="post">
				<input type="hidden" name="tag" value="${tag}" />
				<input type="hidden" name="action" value="delete" />
				$if tag not in excludes and writeok:
					<input type="submit" value="Delete" />
				</form>
		</fieldset>
$elif data_id:
	<p>There are no existing tags on "${data_id}".</p>
$else:
	<p>There are no existing tags in the catalog.</p>
