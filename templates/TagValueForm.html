$def with (args)
$# 
$# Copyright 2010 University of Southern California
$# 
$# Licensed under the Apache License, Version 2.0 (the "License");
$# you may not use this file except in compliance with the License.
$# You may obtain a copy of the License at
$# 
$#    http://www.apache.org/licenses/LICENSE-2.0
$# 
$# Unless required by applicable law or agreed to in writing, software
$# distributed under the License is distributed on an "AS IS" BASIS,
$# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
$# See the License for the specific language governing permissions and
$# limitations under the License.
$#
$ tagname = args.get('tagname')
$ typestr = args.get('typestr')
$ typevals = args.get('typevals')
$ val = args.get('val')
$ type = args.get('type')
$ id = args.get('id')
$ name = args.get('name')
$ disabled = args.get('disabled')
$ readonly = args.get('readonly', '')
$if type:
	<td>
	<input id="${id}" type="${type}" value="${val}" ${readonly} 
	$if name:
		name="${name}"
	$if disabled:
		disabled="disabled"
	/>
$else:
	<td class="file-tag ${idquote(tagname)} multivalue">
	$if typevals:
		$# this lambda is to simulate ternary operator in Python 2.4
		${val} ${(lambda s: ("", "(%s)" % s)[len(s) > 0])(typevals.get(val, ''))}
	$elif typestr == 'url':
		<a href="${val}">${val}</a>
	$elif typestr == 'file':
		<a href="${home}/file/${urlquote(val)}">${val}</a>
	$elif typestr == 'vfile':
		$ parts = val.split('@')
		$ version = parts[-1]
		$ base = '@'.join(parts[0:-1])
		<a href="${home}/file/${urlquote(base)+'@'+version}">${base+'@'+version}</a>
	$else:
		${val}
</td>
