$def with (title, files, tagdefs)
$# 
$# Copyright 2010 University of Southern California
$# 
$# Licensed under the Apache License, Version 2.0 (the "License");
$# you may not use this file except in compliance with the License.
$# You may obtain a copy of the License at
$# 
$#    http://www.apache.org/licenses/LICENSE-2.0
$# 
$# Unless required by applicable law or agreed to in writing, software
$# distributed under the License is distributed on an "AS IS" BASIS,
$# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
$# See the License for the specific language governing permissions and
$# limitations under the License.
$# 
$if title:
	<h2>${title}</h2>
$if title == 'System' and data_id:
	<a href="${home + '/file/' + urlquote(data_id)}">Link to ${data_id}</a>
$ odd = True
<table class="file-list">
$if tagspace == 'tagdefacl':
	<tr class="file-heading"><th class="file-name">Tag</th><th class="file-tag">ACL</th><th class="file-tag">Member(s)</th></tr>
$else:
	<tr class="file-heading"><th class="file-name">File</th><th class="file-tag">Tag</th><th class="file-tag">Value(s)</th></tr>
$for file in files:
	$for tagdef in tagdefs:
		$if tagdef.typestr and tagspace=='tagdefacl' and ((tagdef.tagname=='readers' and file.readpolicy!='tag') or (tagdef.tagname=='writers' and file.writepolicy!='tag')):
			<!-- tagdef ${file.file} does not have ${tagdef.tagname} ACL. -->
		$else:
			$if odd:
				<tr class="file odd"><td class="file-name">${file.file}</td><td>${tagdef.tagname}</td>
			$else:
				<tr class="file even"><td class="file-name">${file.file}</td><td>${tagdef.tagname}</td>
			$ odd = not odd
			$if tagdef.typestr != '':
				<td class="file-tag"><table>
				$if tagdef.multivalue:
					$for val in file[tagdef.tagname]:
						<tr><td class="file-tag multivalue">${val}</td></tr>
				$else:
					<tr><td class="file-tag multivalue">${file[tagdef.tagname]}</td></tr>
				</table></td>
			</tr>
</table>
