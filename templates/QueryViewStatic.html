$def with (ops, predlist, limit=None)
$# 
$# Copyright 2010 University of Southern California
$# 
$# Licensed under the Apache License, Version 2.0 (the "License");
$# you may not use this file except in compliance with the License.
$# You may obtain a copy of the License at
$# 
$#    http://www.apache.org/licenses/LICENSE-2.0
$# 
$# Unless required by applicable law or agreed to in writing, software
$# distributed under the License is distributed on an "AS IS" BASIS,
$# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
$# See the License for the specific language governing permissions and
$# limitations under the License.
$#
$ opsdict = dict(ops)
<h3>Query Terms</h3>
<p><a href="${queryTarget}">Permanent link to this query</a></p>
<p><a href="${queryTarget}?action=edit">Edit query terms</a></p>
$if len(predlist) == 0:
	<p>Match all files.</p>
$else:
	<p>Match files tagged with all of the following tags:</p>
<ul>
$for pred in predlist:
	<li><b>${pred['tag']}</b>
	$if pred['op'] == None:
		<i>${opsdict['']}</i>
	$else:
		<i>${opsdict[pred['op']]}</i>
	$if pred['vals']:
		"${','.join(pred['vals'])}"
	</li>
</ul>
<h3>Matching Datasets</h3>
$if limit:
	<p><b>Results limited to ${limit} matches. Use limit=none query parameter to retrieve all matches.</b></p>