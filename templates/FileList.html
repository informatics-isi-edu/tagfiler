$def with (target, files, referer, quote)
$if len(files) > 0:
	$for name, local, writeok in files:
		$ links = []
		$if local:
			$ links.append( '<a href="file/%s">Download</a>' % quote(name) )
		$else:
			$ links.append( '<a href="file/%s">View</a>' % quote(name) )
		$ links.append( '<a href="tags/%s">Tags</a>' % quote(name) )
		$if writeok:
			$for type in [ 'file', 'url' ]:
				$ links.append( '<a href="file/%s?action=define&amp;type=%s">Replace with %s</a>' % (quote(name), type, type) )
		<fieldset>
		  <legend>${name}</legend>
		  <table>
		  <tr>
		  <td>
			  $:{', '.join(links)}
		  </td>
		  <td>
		  $if False:
		  	<form enctype="application/x-www-form-urlencoded" action="file/${quote(name)}" method="post">
			    <div>
			    <input type="hidden" name="action" value="delete" />
			    <input type="hidden" name="referer" value="${referer}" />
			    <input type="submit" value="Delete" />
			    </div>
			</form>
		  </td>
		  </tr>
		  </table>
		</fieldset>
$else:
	<p>There are no files to list.</p>
