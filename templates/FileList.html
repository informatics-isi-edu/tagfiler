$def with (files, showversions=False)
$ odd = True
$if view:
	$ querystr = '?view=%s' % urlquote(view)
$else:
	$ querystr = ''
$if len(files) > 0:
	<table class="file-list">
	<tr class="file-heading">
	<th class="file-name">Dataset</th>
	<th class="file-tags">Tags</th>
	<th class="file-update">Update</th>
	$for tag in filelisttags:
		<th class="file-tag ${idquote(tag)}">$:{tag.replace(" ", "&nbsp;")}</th>
	</tr>
	$for file in files:
		$if odd:
			<tr class="file odd">
		$else:
			<tr class="file even">
		$ odd = not odd
		<td class="file-name">
		$if showversions:
			$ version = '@%d' % file.version
			$ vsuffix = '@%d' % file.version
		$else:
			$ version = ''
			$ vsuffix = ''
		<a href="${homepath}/file/${urlquote(file.file)}${vsuffix}">${file.file}${version}</a>
		$if file['Image Set']:
			<a href="${homepath}/study/${urlquote(file.file)}${vsuffix}?action=download">all&nbsp;parts</a>
		$if file.writeok:
			<form enctype="application/x-www-form-urlencoded" action="${homepath}/file/${urlquote(file.file)}${vsuffix}" method="post">
			    <div>
			    <input type="hidden" name="action" value="delete" />
			    <input type="hidden" name="referer" value="${referer}" />
			    <input type="submit" value="Delete" />
			    </div>
			</form>
		</td>
		<td class="file-tags">
			<a href="${homepath}/tags/${urlquote(file.file)}${vsuffix}">All Tags</a>
			$if 'Modality' in filelisttags and file['Modality'] == 'fundus' and not file['Image Set']:
				<br /><a href="${homepath}/tags/${urlquote(file.file)}${vsuffix}?view=fundus+tags">Fundus Grade</a>
		</td>
		<td class="file-update">
		$if file.writeok:
			<a href="${homepath}/file/${urlquote(file.file)}${vsuffix}?action=define&amp;type=file">Replace&nbsp;with&nbsp;file</a><br />
			<a href="${homepath}/file/${urlquote(file.file)}${vsuffix}?action=define&amp;type=url">Replace&nbsp;with&nbsp;url</a><br />
			<a href="${homepath}/file/${urlquote(file.file)}${vsuffix}?action=define&amp;type=dataset">Replace&nbsp;with&nbsp;dataset</a>
		</td>
		$for tag in filelisttags:
			$if tagdefsdict.has_key(tag):
				<td class="file-tag ${idquote(tag)}">
				$:{render.FileTagValBlock(file, tagdefsdict[tag], filelisttagswrite, version)}
				</td>
		</tr>
	</table>
$else:
	<p>There are no items to list with your current privileges.</p>
