$def with (files, tagdefs)
$if None:
	$# 
	$# Copyright 2010 University of Southern California
	$# 
	$# Licensed under the Apache License, Version 2.0 (the "License");
	$# you may not use this file except in compliance with the License.
	$# You may obtain a copy of the License at
	$# 
	$#    http://www.apache.org/licenses/LICENSE-2.0
	$# 
	$# Unless required by applicable law or agreed to in writing, software
	$# distributed under the License is distributed on an "AS IS" BASIS,
	$# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
	$# See the License for the specific language governing permissions and
	$# limitations under the License.
	$#
$# the following nonsense line is due to a bug in the template engine... don't know why it works but it does!
$for foo in [ 0 ]:
$code
	def rendertagvals():
		s = ""
		for file in files:
			if file.name != None:
				subject = file.name
			elif file.tagdef != None:
				subject = 'tagdef=' + file.tagdef
			elif file.config != None:
				subject = 'config=' + file.config
			elif file.view != None:
				subject = 'view=' + file.view
			elif file.typedef != None:
				subject = 'typedef=' + file.typedef
			else:
				subject = 'id=' + file.id
			for tagdef in tagdefs:
				if file[tagdef.tagname]:
					if tagdef.typestr == 'empty':
						s += home + "/tags/" + subject + "(" + tagdef.tagname + ")\n"
					elif tagdef.multivalue:
						s += home + "/tags/" + subject + "(" + tagdef.tagname + "=" + ','.join([str(val) for val in file[tagdef.tagname]]) + ")\n"
					else:
						s += home + "/tags/" + subject + "(" + tagdef.tagname + "=" + str(file[tagdef.tagname]) + ")\n"
		return s
${rendertagvals()[:-1]}
